---
## Front matter
title: "Отчёт по лабораторной работе №14"
subtitle: "Партиции, файловые системы, монтирование"
author: "Щемелев Илья Владимирович"

## Generic otions
lang: ru-RU
toc-title: "Содержание"

## Bibliography
bibliography: bib/cite.bib
csl: pandoc/csl/gost-r-7-0-5-2008-numeric.csl

## Pdf output format
toc: true
toc-depth: 2
lof: true
lot: true
fontsize: 12pt
linestretch: 1.5
papersize: a4
documentclass: scrreprt
## I18n polyglossia
polyglossia-lang:
  name: russian
  options:
    - spelling=modern
    - babelshorthands=true
polyglossia-otherlangs:
  name: english
## I18n babel
babel-lang: russian
babel-otherlangs: english
## Fonts
mainfont: IBM Plex Serif
romanfont: IBM Plex Serif
sansfont: IBM Plex Sans
monofont: IBM Plex Mono
mathfont: STIX Two Math
mainfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
romanfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
sansfontoptions: Ligatures=Common,Ligatures=TeX,Scale=MatchLowercase,Scale=0.94
monofontoptions: Scale=MatchLowercase,Scale=0.94,FakeStretch=0.9
mathfontoptions:
## Biblatex
biblatex: true
biblio-style: "gost-numeric"
biblatexoptions:
  - parentracker=true
  - backend=biber
  - hyperref=auto
  - language=auto
  - autolang=other*
  - citestyle=gost-numeric
## Pandoc-crossref LaTeX customization
figureTitle: "Рис."
tableTitle: "Таблица"
listingTitle: "Листинг"
lofTitle: "Список иллюстраций"
lotTitle: "Список таблиц"
lolTitle: "Листинги"
## Misc options
indent: true
header-includes:
  - \usepackage{indentfirst}
  - \usepackage{float}
  - \floatplacement{figure}{H}
---

# Цель работы

Получить навыки создания разделов на диске и файловых систем. Получить навыки монтирования файловых систем.

# Ход выполнения

## Создание разделов MBR с помощью утилиты fdisk

1. Виртуальная машина была запущена с подключёнными дополнительными виртуальными дисками.  
   В системе присутствуют три диска: системный диск **/dev/sda** объёмом 50 ГБ, а также два дополнительных диска **/dev/sdb** и **/dev/sdc** объёмом по 1.5 ГБ каждый.

   Для просмотра перечня всех доступных дисков и их текущей разметки выполнена команда `fdisk --list`.  
   В выводе команды отображается информация о дисках **/dev/sdb** и **/dev/sdc**, не содержащих таблицы разделов, что подтверждает их готовность к разметке.

   ![Просмотр списка дисков с помощью fdisk](Screenshot_1.png)

2. Для выполнения разметки был выбран диск **/dev/sdb**.  
   Утилита **fdisk** запущена с правами администратора. Поскольку диск ранее не содержал таблицы разделов, автоматически была создана таблица разделов типа **DOS (MBR)**.

   Для ознакомления с доступными командами в интерактивном режиме была выведена справка по командам fdisk.

   ![Запуск fdisk и справка по командам](Screenshot_2.png)

3. Перед созданием разделов выполнен просмотр текущей таблицы разделов.  
   На данном этапе диск **/dev/sdb** не содержит ни одного раздела, что указывает на наличие полностью свободного пространства.

4. Создан основной (primary) раздел на диске **/dev/sdb**.  
   В качестве параметров были использованы значения по умолчанию для начального сектора, а размер раздела задан равным **300 МиБ**.  
   Разделу автоматически присвоен тип **Linux (83)** и номер **/dev/sdb1**.

   После завершения настройки изменения записаны на диск.

   ![Создание основного раздела](Screenshot_3.png)

5. Для проверки результата выполнен просмотр таблицы разделов диска **/dev/sdb**, а также содержимого файла **/proc/partitions**.  
   Таблица разделов, полученная с помощью fdisk, содержит информацию о разделе **/dev/sdb1**, однако файл **/proc/partitions** на данном этапе не отражает новый раздел, так как изменения ещё не были загружены в ядро.

   ![Проверка таблицы разделов и /proc/partitions](Screenshot_4.png)

   **Разница между выводами:**  
   Команда `fdisk -l` считывает информацию напрямую с диска, тогда как файл `/proc/partitions` отображает текущее состояние таблицы разделов, загруженной в ядро Linux. До выполнения синхронизации эти данные могут не совпадать.

6. Для обновления таблицы разделов ядра выполнена синхронизация.  
   После этого повторный просмотр файла **/proc/partitions** показал наличие раздела **sdb1**, что подтверждает корректную загрузку изменений.

7. Далее выполнено создание логических разделов.  
   Сначала создан расширенный (extended) раздел, который занял всё оставшееся свободное пространство диска и получил номер **/dev/sdb4**.

   Затем внутри расширенного раздела создан логический раздел размером **300 МиБ**, автоматически получивший номер **/dev/sdb5** и тип **Linux (83)**.

   Все изменения записаны на диск.

   ![Создание расширенного и логического разделов](Screenshot_5.png)

8. После синхронизации таблицы разделов выполнена проверка состояния диска.  
   В системе корректно отображаются основной, расширенный и логический разделы, что подтверждается выводом информации о разделах.

   ![Проверка логических разделов](Screenshot_6.png)

9. Для создания раздела подкачки вновь запущена утилита **fdisk**.  
   Создан дополнительный логический раздел размером **300 МиБ**, которому присвоен номер **/dev/sdb6**.  
   Тип данного раздела изменён на **Linux swap / Solaris (82)**.

   Изменения записаны на диск.

   ![Создание раздела подкачки](Screenshot_7.png)

10. Выполнена итоговая проверка таблицы разделов диска **/dev/sdb**.  
    В системе присутствуют следующие разделы:
    - **/dev/sdb1** — основной раздел Linux, 300 МиБ;
    - **/dev/sdb4** — расширенный раздел;
    - **/dev/sdb5** — логический раздел Linux, 300 МиБ;
    - **/dev/sdb6** — логический раздел подкачки, 300 МиБ.

11. Раздел подкачки был отформатирован и активирован.  
    После активации выполнена проверка использования оперативной памяти и пространства подкачки.  
    В выводе отображается активное пространство swap, что подтверждает успешное завершение настройки.

    ![Активация и проверка swap-раздела](Screenshot_8.png)

## Создание разделов GPT с помощью утилиты gdisk

1. В терминале с полномочиями администратора выполнен просмотр таблицы разделов на дополнительном диске **/dev/sdc**.  
   В результате проверки установлено, что на диске отсутствуют таблицы разделов MBR и GPT, что позволяет создать новую таблицу разделов GPT.

   ![Просмотр таблицы разделов диска /dev/sdc](Screenshot_9.png)

2. Для создания GPT-разметки запущена утилита **gdisk** для диска **/dev/sdc**.  
   При запуске утилита автоматически создала новую таблицу разделов GPT в памяти, так как ранее разметка на диске отсутствовала.

3. С помощью команды добавления нового раздела создан первый раздел.  
   Был принят номер раздела по умолчанию — **1**, начальный сектор выбран автоматически, а размер раздела задан равным **300 МиБ**.  
   Тип раздела установлен по умолчанию — **Linux filesystem (8300)**.

4. Для контроля выполнен просмотр текущей схемы разметки диска.  
   Отображается один раздел **/dev/sdc1** размером 300 МиБ с типом Linux filesystem.

5. После проверки корректности параметров выполнена запись изменений на диск.  
   Таблица разделов GPT успешно сохранена.

   ![Создание GPT-раздела на диске /dev/sdc](Screenshot_10.png)

6. Повторный просмотр таблицы разделов диска **/dev/sdc** подтверждает наличие корректной GPT-разметки и защитного MBR.

   ![Проверка GPT-разметки](Screenshot_11.png)

## Форматирование файловой системы XFS

7. Для основного раздела **/dev/sdb1** создана файловая система **XFS**.  
   После форматирования разделу была присвоена метка файловой системы **xfsdisk**, что упрощает его идентификацию при монтировании.

   ![Форматирование XFS и установка метки](Screenshot_12.png)

## Форматирование файловой системы EXT4

8. Для логического раздела **/dev/sdb5** создана файловая система **EXT4**.  
   Разделу назначена метка **ext4disk**, после чего для файловой системы включены параметры монтирования списков контроля доступа (ACL) и расширенных пользовательских атрибутов.

   ![Форматирование EXT4 и настройка параметров](Screenshot_13.png)

## Ручное монтирование файловых систем

9. Для проверки работоспособности файловой системы создана точка монтирования **/mnt/tmp**.  
   Раздел **/dev/sdb5** был примонтирован в данную директорию, после чего выполнена проверка корректности монтирования.  
   Затем файловая система была успешно отмонтирована.

   ![Ручное монтирование и отмонтирование раздела](Screenshot_14.png)

## Монтирование разделов с помощью /etc/fstab

10. Для постоянного монтирования раздела **/dev/sdb1** создана точка монтирования **/mnt/data**.  
    С помощью утилиты определения блочных устройств получен UUID раздела **/dev/sdb1**.

    ![Просмотр UUID блочных устройств](Screenshot_15.png)

11. Файл **/etc/fstab** был открыт на редактирование, после чего в него добавлена строка для автоматического монтирования раздела **/dev/sdb1** по UUID в каталог **/mnt/data** с файловой системой XFS.

    ![Редактирование файла /etc/fstab](Screenshot_16.png)

12. Для проверки корректности конфигурации выполнено автоматическое монтирование всех файловых систем, указанных в **/etc/fstab**.  
    После этого выполнен просмотр списка смонтированных файловых систем, который подтвердил успешное монтирование раздела **/dev/sdb1** в каталог **/mnt/data**.

    ![Проверка автоматического монтирования](Screenshot_17.png)

## Самостоятельная работа: создание дополнительных GPT-разделов, настройка автоподключения и проверка после перезагрузки

1. На диске с GPT-разбиением **/dev/sdc** выполнено создание двух дополнительных разделов с помощью утилиты **gdisk**.  
   В результате на диске сформированы три раздела, из которых два новых были добавлены для выполнения самостоятельной работы:
   - **/dev/sdc2** — раздел файловой системы Linux (тип **8300**) размером **300 MiB**;
   - **/dev/sdc3** — раздел подкачки Linux swap (тип **8200**) размером **300 MiB**.  

   После формирования разметки выполнена запись изменений на диск и обновление таблицы разделов в ядре командой `partprobe /dev/sdc`.

   ![Итоговая схема GPT-разделов и обновление таблицы разделов](Screenshot_18.png)

2. Раздел **/dev/sdc2** отформатирован в файловую систему **ext4**.  
   Для упрощения идентификации разделу назначена метка **ext4disk2**, после чего включены параметры монтирования по умолчанию: **acl** и **user_xattr**.

   ![Форматирование ext4, установка метки и параметров монтирования](Screenshot_19.png)

3. Для раздела подкачки **/dev/sdc3** выполнено создание swap-области.  
   Раздел подготовлен командой форматирования подкачки, после чего он стал доступен для дальнейшего подключения в качестве swap.

   ![Создание swap-раздела на /dev/sdc3](Screenshot_19.png)

4. Для корректной настройки автоматического подключения получены UUID созданных разделов.  
   В выводе утилиты идентификации блочных устройств отображаются параметры разделов диска **/dev/sdc**, включая:
   - UUID раздела **/dev/sdc2** (ext4);
   - UUID раздела **/dev/sdc3** (swap).

   ![Просмотр UUID разделов](Screenshot_20.png)

5. Выполнена настройка автоматического монтирования и подключения swap через файл **/etc/fstab**.  
   В конфигурацию добавлены строки:
   - для монтирования **/dev/sdc2** в каталог **/mnt/data-ext** с типом **ext4**;
   - для подключения **/dev/sdc3** как области подкачки (swap).

   ![Редактирование /etc/fstab с добавлением ext4 и swap](Screenshot_21.png)

6. После внесения изменений выполнена проверка корректности настроек.  
   Система была перезагружена, после чего выполнен контроль:
   - список смонтированных файловых систем подтверждает, что **/dev/sdc2** смонтирован в **/mnt/data-ext**;
   - вывод `df -h` показывает присутствие точки монтирования **/mnt/data-ext** и корректное отображение раздела ext4;
   - состояние памяти подтверждает наличие подключённой области подкачки.

   ![Проверка монтирования и состояния системы после перезагрузки](Screenshot_22.png)

# Контрольные вопросы

1. **Какой инструмент используется для создания разделов GUID?**

   Для создания разделов с таблицей GUID Partition Table (GPT) используется утилита **gdisk**.  
   Данный инструмент предназначен для работы с дисками, размеченными по стандарту GPT, и позволяет:
   - создавать, удалять и изменять разделы;
   - задавать типы разделов (например, Linux filesystem, Linux swap, Linux LVM);
   - просматривать и редактировать GUID-диск.

   Утилита **gdisk** является функциональным аналогом fdisk, но ориентирована именно на GPT-разметку.

2. **Какой инструмент применяется для создания разделов MBR?**

   Для работы с таблицей разделов MBR (DOS) применяется утилита **fdisk**.  
   Она используется для:
   - создания первичных, расширенных и логических разделов;
   - изменения типов разделов;
   - записи таблицы разделов MBR на диск.

   Утилита fdisk традиционно используется для дисков с классической схемой разметки MBR.

3. **Какой файл используется для автоматического монтирования разделов во время загрузки?**

   Для автоматического монтирования файловых систем при загрузке системы используется файл **/etc/fstab**.  
   В данном файле указываются:
   - UUID или имя устройства;
   - точка монтирования;
   - тип файловой системы;
   - параметры монтирования;
   - порядок проверки и монтирования.

   Система считывает этот файл при запуске и автоматически монтирует указанные разделы.

4. **Какой вариант монтирования целесообразно выбрать, если необходимо, чтобы файловая система не была автоматически примонтирована во время загрузки?**

   В этом случае раздел **не следует добавлять** в файл **/etc/fstab**.  
   Такой подход позволяет:
   - монтировать файловую систему вручную при необходимости;
   - избежать ошибок загрузки системы в случае проблем с устройством.

   Альтернативно можно использовать опцию `noauto` в /etc/fstab, если запись присутствует, но автоматическое монтирование нежелательно.

5. **Какая команда позволяет форматировать раздел с типом 82 с соответствующей файловой системой?**

   Раздел с типом **82 (Linux swap)** форматируется командой **mkswap**.  
   Данная команда подготавливает раздел для использования в качестве пространства подкачки и создаёт на нём соответствующую структуру swap.

6. **Вы только что добавили несколько разделов для автоматического монтирования при загрузке. Как можно безопасно проверить, будет ли это работать без реальной перезагрузки?**

   Для безопасной проверки корректности настроек файла **/etc/fstab** используется команда **mount -a**.  
   Она выполняет попытку смонтировать все файловые системы, указанные в fstab, кроме тех, для которых задана опция `noauto`.

   Если ошибок не возникает, можно считать, что конфигурация корректна и будет работать при следующей загрузке системы.

7. **Какая файловая система создаётся, если вы используете команду mkfs без какой-либо спецификации файловой системы?**

   При использовании команды **mkfs** без указания типа файловой системы по умолчанию создаётся файловая система **ext2**.  
   Это поведение обусловлено тем, что mkfs является обобщающей оболочкой, а ext2 исторически считается базовой файловой системой Linux.

8. **Как форматировать раздел EXT4?**

   Для форматирования раздела в файловую систему **EXT4** используется команда **mkfs.ext4**.  
   Она создаёт журналируемую файловую систему ext4, которая поддерживает:
   - журналирование;
   - расширенные атрибуты;
   - списки контроля доступа (ACL);
   - большие объёмы данных и файлов.

   Дополнительно можно задать метку файловой системы и параметры монтирования.

9. **Как найти UUID для всех устройств на компьютере?**

   Для определения UUID всех блочных устройств используется утилита **blkid**.  
   Она выводит информацию о:
   - UUID устройства;
   - типе файловой системы;
   - метке тома;
   - типе раздела (swap, ext4, xfs и т.д.).

   UUID применяется для надёжной идентификации устройств, так как не зависит от изменения имён устройств при загрузке системы.

# Заключение

В ходе выполнения лабораторной работы были изучены и отработаны основные операции по разметке жёстких дисков с использованием схем **MBR** и **GPT**. Были созданы первичные, расширенные и логические разделы, а также разделы подкачки, выполнено форматирование файловых систем **XFS** и **EXT4** с настройкой их параметров.

Дополнительно были освоены методы ручного и автоматического монтирования файловых систем, включая настройку файла **/etc/fstab** и проверку корректности конфигурации без перезагрузки системы. Проведена проверка работоспособности настроек после перезагрузки, что подтвердило корректность выполненных действий.

Полученные навыки позволяют уверенно выполнять базовые задачи администрирования дискового пространства и файловых систем в операционных системах семейства Linux.
