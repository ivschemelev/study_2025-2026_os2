---
## Front matter
title: "Отчёт по лабораторной работе №8"
subtitle: "Планировщики событий"
author: "Щемелев Илья Владимирович"

## Generic otions
lang: ru-RU
toc-title: "Содержание"

## Bibliography
bibliography: bib/cite.bib
csl: pandoc/csl/gost-r-7-0-5-2008-numeric.csl

## Pdf output format
toc: true
toc-depth: 2
lof: true
lot: true
fontsize: 12pt
linestretch: 1.5
papersize: a4
documentclass: scrreprt
## I18n polyglossia
polyglossia-lang:
  name: russian
  options:
    - spelling=modern
    - babelshorthands=true
polyglossia-otherlangs:
  name: english
## I18n babel
babel-lang: russian
babel-otherlangs: english
## Fonts
mainfont: IBM Plex Serif
romanfont: IBM Plex Serif
sansfont: IBM Plex Sans
monofont: IBM Plex Mono
mathfont: STIX Two Math
mainfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
romanfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
sansfontoptions: Ligatures=Common,Ligatures=TeX,Scale=MatchLowercase,Scale=0.94
monofontoptions: Scale=MatchLowercase,Scale=0.94,FakeStretch=0.9
mathfontoptions:
## Biblatex
biblatex: true
biblio-style: "gost-numeric"
biblatexoptions:
  - parentracker=true
  - backend=biber
  - hyperref=auto
  - language=auto
  - autolang=other*
  - citestyle=gost-numeric
## Pandoc-crossref LaTeX customization
figureTitle: "Рис."
tableTitle: "Таблица"
listingTitle: "Листинг"
lofTitle: "Список иллюстраций"
lotTitle: "Список таблиц"
lolTitle: "Листинги"
## Misc options
indent: true
header-includes:
  - \usepackage{indentfirst}
  - \usepackage{float}
  - \floatplacement{figure}{H}
---

# Цель работы

Получение навыков работы с планировщиками событий cron и at.

# Ход выполнения

## Планирование задач с помощью cron

1. Для выполнения операций администрирования был запущен терминал и получены полномочия суперпользователя с помощью команды su -.  
   Это обеспечило доступ к системным службам и файлам конфигурации, необходимым для настройки планировщика задач.

2. Выполнена проверка состояния демона планировщика задач crond.  
   В результате установлено, что служба crond.service загружена, включена в автозапуск и находится в состоянии active (running), что подтверждает корректную работу планировщика задач.

   ![Статус службы crond](Screenshot_1.png)

3. Просмотрено содержимое системного файла конфигурации /etc/crontab.  
   Файл содержит переменные окружения SHELL, PATH, MAILTO и комментарии с описанием синтаксиса заданий cron. Пользовательские задания в данном файле отсутствуют.

   ![Содержимое файла /etc/crontab](Screenshot_2.png)

4. Выполнен просмотр списка заданий текущего пользователя.  
   Вывод отсутствует, что свидетельствует об отсутствии ранее настроенных заданий в пользовательском расписании.

5. Файл пользовательского расписания открыт для редактирования.  
   В редакторе добавлена строка:

   */1 * * * * logger This message is written from root cron

   Пояснение синтаксиса записи:
   - */1 — выполнение каждую минуту;
   - * — каждый час;
   - * — каждый день месяца;
   - * — каждый месяц;
   - * — каждый день недели;
   - logger — команда записи сообщения в системный журнал.

   ![Редактирование crontab](Screenshot_3.png)

6. После сохранения изменений повторно выполнен просмотр списка заданий.  
   В расписании отображается добавленное задание, что подтверждает успешную установку расписания.

   ![Список заданий crontab](Screenshot_4.png)

7. Через 2–3 минуты выполнен просмотр системного журнала.  
   В журнале зафиксированы регулярные сообщения, создаваемые заданием cron, что подтверждает его корректное выполнение.

   ![Сообщения cron в журнале](Screenshot_5.png)

8. Запись в расписании cron изменена на следующую:

   0 */1 * * 1-5 logger This message is written from root cron

   Пояснение синтаксиса записи:
   - 0 — выполнение в нулевую минуту часа;
   - */1 — каждый час;
   - * — любой день месяца;
   - * — любой месяц;
   - 1–5 — с понедельника по пятницу;
   - logger — запись сообщения в журнал.

9. Повторно выполнен просмотр списка заданий cron.  
   В выводе отображается обновлённая запись.

10. Выполнен переход в каталог /etc/cron.hourly и создан файл сценария eachhour.

11. Файл eachhour открыт для редактирования, в него добавлен сценарий записи сообщения в системный журнал с указанием текущих даты и времени.

   ![Сценарий eachhour](Screenshot_6.png)

12. Файлу сценария eachhour выданы права на исполнение, что позволило системе выполнять его по расписанию.

13. В каталоге /etc/cron.d создан файл расписания eachhour, в который добавлена строка:

   11 * * * * root logger This message is written from /etc/cron.d

   Пояснение синтаксиса записи:
   - 11 — выполнение на 11-й минуте каждого часа;
   - * * * — любой час, день месяца и месяц;
   - * — любой день недели;
   - root — пользователь, от имени которого выполняется команда;
   - logger — запись сообщения в системный журнал.

   ![Файл расписания в /etc/cron.d](Screenshot_7.png)

14. Через установленный промежуток времени выполнен анализ системного журнала.  
   По наличию соответствующих сообщений подтверждено, что сценарий eachhour запускался в соответствии с заданным расписанием.

## Планирование заданий с помощью at

1. Получены полномочия администратора.

2. Проверено состояние службы отложенного выполнения заданий atd.  
   Установлено, что служба загружена, включена и находится в состоянии active (running).

   ![Статус службы atd](Screenshot_8.png)

3. Задано отложенное выполнение команды записи сообщения в системный журнал на указанное время.  
   После завершения ввода задание было принято системой к исполнению.

4. Выполнена проверка очереди заданий at.  
   После наступления заданного времени в системном журнале зафиксировано сообщение, подтверждающее успешное выполнение задания.


# Контрольные вопросы

1. Чтобы задание cron выполнялось раз в 2 недели, используется указание дня недели и шага в поле недели.  
   Так как cron не поддерживает прямое понятие «неделя», обычно выбирается конкретный день недели с шагом 2.

   Пример выполнения задания раз в две недели по понедельникам в 3 часа ночи:

```
0 3 * * 1/2 команда
```

Здесь:
- `0` — минута;
- `3` — час;
- `*` — любой день месяца;
- `*` — любой месяц;
- `1/2` — каждый второй понедельник.

2. Для выполнения задания 1-го и 15-го числа каждого месяца в 2 часа ночи используется перечисление значений в поле дня месяца.

Пример записи:

```
0 2 1,15 * * команда
```

Здесь:
- `0` — нулевая минута;
- `2` — 2 часа ночи;
- `1,15` — 1-е и 15-е число месяца;
- `*` — любой месяц;
- `*` — любой день недели.

3. Для выполнения задания каждые 2 минуты каждый день применяется шаг в поле минут.

Пример записи:

```
*/2 * * * * команда
```

Здесь:
- `*/2` — каждые 2 минуты;
- остальные поля со значением `*` означают любое время, день и месяц.

4. Для выполнения задания 19 сентября ежегодно указываются конкретные день и месяц.

Пример записи:

```
0 0 19 9 * команда
```

Здесь:
- `0` — минута;
- `0` — час;
- `19` — день месяца;
- `9` — сентябрь;
- `*` — любой день недели.

5. Для выполнения задания каждый четверг сентября ежегодно используется указание месяца и дня недели.

Пример записи:

```
0 1 * 9 4 команда
```

Здесь:
- `0` — минута;
- `1` — час;
- `*` — любой день месяца;
- `9` — сентябрь;
- `4` — четверг.

6. Для назначения задания cron конкретному пользователю используется команда переключения на этого пользователя либо параметр `-u` (для администратора).

Пример назначения задания пользователю alice:

```
crontab -u alice -e
```

После выполнения команды открывается файл расписания cron пользователя alice, в который можно добавить необходимые задания.

7. Чтобы запретить пользователю bob назначать задания через cron, используется файл `/etc/cron.deny`.

Пример:
- открыть файл `/etc/cron.deny`;
- добавить в него строку: `bob`

После этого пользователь bob не сможет использовать команду crontab.

8. Чтобы задание выполнялось каждый день даже в случае временной недоступности сервера, рекомендуется использовать планировщик `anacron`.  
Anacron гарантирует выполнение заданий после включения системы, если они были пропущены во время простоя.

Для этого задание следует разместить в конфигурации anacron или в каталогах `/etc/cron.daily`, `/etc/cron.weekly`.

9. Для проверки наличия заданий, запланированных планировщиком atd, используется команда: `atq`

Команда выводит список всех отложенных заданий. Если список пуст, значит задания at не запланированы.

# Заключение

В ходе лабораторной работы были изучены и практически освоены средства планирования заданий в операционной системе Linux с использованием планировщиков cron и at. Выполнена настройка периодических и отложенных задач, проверена работа соответствующих служб и проанализированы результаты выполнения заданий по системным журналам. Полученные навыки позволяют автоматизировать выполнение административных операций и эффективно управлять задачами в серверной среде.
