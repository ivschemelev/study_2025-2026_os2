---
## Front matter
title: "Отчёт по лабораторной работе №3"
subtitle: "Настройка прав доступа"
author: "Щемелев Илья Владимирович"

## Generic otions
lang: ru-RU
toc-title: "Содержание"

## Bibliography
bibliography: bib/cite.bib
csl: pandoc/csl/gost-r-7-0-5-2008-numeric.csl

## Pdf output format
toc: true
toc-depth: 2
lof: true
lot: true
fontsize: 12pt
linestretch: 1.5
papersize: a4
documentclass: scrreprt
## I18n polyglossia
polyglossia-lang:
  name: russian
  options:
    - spelling=modern
    - babelshorthands=true
polyglossia-otherlangs:
  name: english
## I18n babel
babel-lang: russian
babel-otherlangs: english
## Fonts
mainfont: IBM Plex Serif
romanfont: IBM Plex Serif
sansfont: IBM Plex Sans
monofont: IBM Plex Mono
mathfont: STIX Two Math
mainfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
romanfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
sansfontoptions: Ligatures=Common,Ligatures=TeX,Scale=MatchLowercase,Scale=0.94
monofontoptions: Scale=MatchLowercase,Scale=0.94,FakeStretch=0.9
mathfontoptions:
## Biblatex
biblatex: true
biblio-style: "gost-numeric"
biblatexoptions:
  - parentracker=true
  - backend=biber
  - hyperref=auto
  - language=auto
  - autolang=other*
  - citestyle=gost-numeric
## Pandoc-crossref LaTeX customization
figureTitle: "Рис."
tableTitle: "Таблица"
listingTitle: "Листинг"
lofTitle: "Список иллюстраций"
lotTitle: "Список таблиц"
lolTitle: "Листинги"
## Misc options
indent: true
header-includes:
  - \usepackage{indentfirst}
  - \usepackage{float}
  - \floatplacement{figure}{H}
---

# Цель работы

Получение навыков настройки базовых и специальных прав доступа для групп пользователей в операционной системе типа Linux.

# Ход выполнения

## Управление базовыми разрешениями доступа

1. В терминале выполнен вход под учётной записью **root** с использованием команды `su`.  
   После успешной аутентификации получены административные привилегии, необходимые для управления владельцами и правами доступа.

2. В корневом каталоге файловой системы созданы каталоги **/data/main** и **/data/third**.  
   Проверка владельцев и групп показала, что по умолчанию оба каталога принадлежат пользователю и группе **root**.

3. Для разграничения прав доступа изменены группы-владельцы каталогов:  
   каталог **/data/main** назначен группе **main**,  
   каталог **/data/third** — группе **third**.  
   Повторная проверка подтвердила корректное назначение групп.

4. Для обоих каталогов установлены права доступа **770**, что обеспечивает полный доступ владельцу и группе и запрещает доступ всем остальным пользователям.  
   Проверка показала корректную установку разрешений.

   ![Установка базовых прав доступа](Screenshot_1.png)

5. В другом терминале выполнен вход под пользователем **bob**, являющимся членом группы **main**.  
   Пользователь успешно перешёл в каталог **/data/main** и создал файл **emptyfile**, так как группа **main** имеет право записи в данный каталог.

6. Попытка пользователя **bob** перейти в каталог **/data/third** завершилась ошибкой *Permission denied*.  
   Это связано с тем, что пользователь не состоит в группе **third**, а доступ для остальных пользователей запрещён.

## Управление специальными разрешениями (setgid и sticky bit)

7. Под пользователем **alice** в каталоге **/data/main** созданы файлы **alice1** и **alice2**.  
   Созданные файлы принадлежат пользователю **alice** и его основной группе.

8. Под пользователем **bob** выполнена попытка удаления файлов **alice1** и **alice2**.  
   Удаление прошло успешно, так как на данном этапе в каталоге отсутствовал sticky bit, а у группы **main** были права на запись.

9. Пользователь **bob** создал файлы **bob1** и **bob2**.  
   После этого под пользователем **root** для каталога **/data/main** были установлены бит идентификатора группы (**setgid**) и **sticky bit**, что превратило каталог в разделяемый для группы.

   ![Установка setgid и sticky bit](Screenshot_2.png)

10. Пользователь **alice** создал файлы **alice3** и **alice4**.  
    Проверка показала, что файлы автоматически унаследовали группу **main**, что является результатом действия бита **setgid**.

11. Попытка пользователя **alice** удалить файлы **bob1** и **bob2** завершилась неудачей.  
    Sticky bit предотвратил удаление, так как пользователь не является владельцем этих файлов.

## Управление расширенными разрешениями с использованием ACL

12. Под пользователем **root** установлены расширенные права доступа ACL:  
    группе **third** предоставлены права чтения и выполнения в каталоге **/data/main**,  
    группе **main** — права чтения и выполнения в каталоге **/data/third**.  
    Проверка ACL подтвердила корректность настроек.

    ![Настройка ACL и проверка getfacl](Screenshot_3.png)

13. В каталоге **/data/main** создан файл **newfile1**.  
    Проверка показала, что файл получил только стандартные права доступа, так как ACL по умолчанию для каталога ещё не были заданы.  
    Аналогичное поведение наблюдалось и в каталоге **/data/third**.

    ![Проверка ACL нового файла](Screenshot_4.png)

14. Для каталогов заданы ACL по умолчанию, обеспечивающие наследование расширенных прав для новых файлов:  
    для **/data/main** — для группы **third**,  
    для **/data/third** — для группы **main**.

    ![Установка ACL по умолчанию](Screenshot_5.png)

15. После создания файлов **newfile2** установлено, что они автоматически унаследовали заданные ACL по умолчанию.  
    Проверка показала наличие соответствующих прав доступа у групп **main** и **third**.

16. Под пользователем **carol**, являющимся членом группы **third**, выполнена проверка доступа.  
    Попытки удаления файлов завершились отказом в доступе, так как пользователь не является владельцем файлов и действует sticky bit.  
    Запись в файлы также оказалась невозможной из-за отсутствия соответствующих прав в ACL.

    ![Проверка прав пользователем carol](Screenshot_6.png)

# Контрольные вопросы

1. Для установки владельца группы для файла используется команда **chown** с указанием имени группы после двоеточия.  
   Такой способ позволяет изменить только групповую принадлежность файла без изменения владельца-пользователя.  
   Например, команда `chown :main file.txt` устанавливает группу **main** владельцем файла *file.txt*.

2. Для поиска всех файлов, принадлежащих конкретному пользователю, применяется команда **find** с параметром `-user`.  
   Она позволяет рекурсивно просмотреть файловую систему или указанный каталог.  
   Например, команда `find /home -user alice` найдёт все файлы пользователя **alice** в каталоге */home* и его подкаталогах.

3. Чтобы применить разрешения на чтение, запись и выполнение для владельца и группы для всех файлов в каталоге */data* и не устанавливать никаких прав для остальных пользователей, используются права **770**.  
   Это обеспечивает полный доступ владельцу и группе и полностью запрещает доступ для категории «other».  
   Например, `chmod -R 770 /data`.

4. Для добавления разрешения на выполнение файлу, который необходимо сделать исполняемым, используется команда **chmod** с символьным указанием права выполнения.  
   Например, `chmod +x script.sh` добавляет право выполнения для всех категорий пользователей.

5. Чтобы убедиться, что групповые разрешения для всех новых файлов, создаваемых в каталоге, будут присвоены владельцу группы этого каталога, используется установка бита идентификатора группы (**setgid**).  
   Это достигается командой `chmod g+s каталог`.  
   Например, `chmod g+s /data/main` гарантирует, что новые файлы унаследуют группу **main**.

6. Для обеспечения возможности удаления файлов только их владельцами или владельцем каталога используется **sticky bit**.  
   Этот атрибут применяется к каталогу и предотвращает удаление файлов посторонними пользователями.  
   Например, `chmod +t /data/main`.

7. Для добавления ACL, предоставляющего членам группы права чтения для всех существующих файлов в текущем каталоге, используется команда **setfacl**.  
   Например, `setfacl -m g:third:r *` добавляет группе **third** право чтения для всех файлов в каталоге.

8. Чтобы гарантировать, что члены группы получат разрешения на чтение для всех файлов в текущем каталоге, во всех его подкаталогах, а также для файлов, которые будут созданы в будущем, необходимо:
   - рекурсивно задать ACL для существующих файлов и каталогов;
   - установить ACL по умолчанию для каталога.  
   Например, `setfacl -R -m g:third:r .` и `setfacl -d -m g:third:r .`.

9. Чтобы пользователи из категории «other» не получали никаких разрешений на новые файлы, необходимо установить значение **umask 007**.  
   В этом случае новые файлы будут создаваться без каких-либо прав для остальных пользователей.  
   Например, `umask 007`.

10. Для гарантии того, что файл *myfile* не сможет быть удалён случайно, используется установка атрибута неизменяемости.  
    Это выполняется командой **chattr** с параметром `+i`.  
    Например, `chattr +i myfile`, после чего файл нельзя будет удалить или изменить до снятия атрибута.

# Заключение

В ходе лабораторной работы были изучены и практически применены механизмы управления доступом в Linux: базовые права, специальные биты **setgid** и **sticky bit**, а также расширенные списки контроля доступа **ACL**.  
Результаты показали, что комбинация данных механизмов позволяет гибко и безопасно организовывать совместный доступ пользователей к файловым ресурсам.

